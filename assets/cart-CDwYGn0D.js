import{I as w,r as s,k as l,A as N}from"./index-DcZlzi53.js";const q=w("cart",()=>{const a=s([]),u=s(null),n=s(""),c=s(""),p=l(()=>a.value.reduce((e,t)=>e+t.quantity,0)),i=l(()=>a.value.reduce((e,t)=>e+t.totalPrice,0)),v=l(()=>a.value.reduce((e,t)=>e+(t.product.cost||0)*t.quantity,0)),d=l(()=>i.value-v.value),y=l(()=>a.value.length===0);function I(e,t=1){const o=a.value.findIndex(r=>r.product.key===e.key);if(o>=0){const r=a.value[o];r.quantity+=t,r.totalPrice=r.unitPrice*r.quantity}else{const r=e.price||0,E={product:e,quantity:t,unitPrice:r,totalPrice:r*t};a.value.push(E)}}function f(e){const t=a.value.findIndex(o=>o.product.key===e);t>=0&&a.value.splice(t,1)}function g(e,t){const o=a.value.find(r=>r.product.key===e);o&&(t<=0?f(e):(o.quantity=t,o.totalPrice=o.unitPrice*t))}function P(e,t){const o=a.value.find(r=>r.product.key===e);o&&(o.unitPrice=t,o.totalPrice=t*o.quantity)}function D(){a.value=[],u.value=null,n.value="",c.value=""}function S(e){u.value=e}function h(e){n.value=e}function C(e){c.value=e}function x(){if(!u.value||a.value.length===0)throw new Error("Carrinho vazio ou cliente nÃ£o selecionado");const e={};return a.value.forEach(t=>{t.product.id&&(e[t.product.id]=t.quantity)}),{customerId:u.value.id,products:e,status:"PENDING",deliveryDate:n.value,cost:v.value,price:i.value,debt:i.value,profit:d.value}}function m(){const e={items:a.value,selectedCustomer:u.value,deliveryDate:n.value,observations:c.value};localStorage.setItem("verly-cart",JSON.stringify(e))}function k(){try{const e=localStorage.getItem("verly-cart");if(e){const t=JSON.parse(e);a.value=t.items||[],u.value=t.selectedCustomer||null,n.value=t.deliveryDate||"",c.value=t.observations||""}}catch(e){console.error("Erro ao carregar carrinho do localStorage:",e)}}function b(){N([a,u,n,c],()=>{m()},{deep:!0})}return{items:a,selectedCustomer:u,deliveryDate:n,observations:c,totalItems:p,totalValue:i,totalCost:v,totalProfit:d,isEmpty:y,addItem:I,removeItem:f,updateQuantity:g,updateUnitPrice:P,clearCart:D,setCustomer:S,setDeliveryDate:h,setObservations:C,getOrderData:x,saveToStorage:m,loadFromStorage:k,setupAutoSave:b}});export{q as u};
