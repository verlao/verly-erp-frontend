import{v as x,G as s,F as i,q as N}from"./index-D6gXMe8l.js";const F=x("cart",()=>{const a=s([]),r=s(null),l=s(""),n=s(""),p=i(()=>a.value.reduce((e,t)=>e+t.quantity,0)),c=i(()=>a.value.reduce((e,t)=>e+t.totalPrice,0)),v=i(()=>a.value.reduce((e,t)=>e+(t.product.cost||0)*t.quantity,0)),d=i(()=>c.value-v.value),m=i(()=>a.value.length===0);function P(e,t=1){const o=a.value.findIndex(u=>u.product.key===e.key);if(o>=0){const u=a.value[o];u.quantity+=t,u.totalPrice=u.unitPrice*u.quantity}else{const u=e.price||0,E={product:e,quantity:t,unitPrice:u,totalPrice:u*t};a.value.push(E)}}function f(e){const t=a.value.findIndex(o=>o.product.key===e);t>=0&&a.value.splice(t,1)}function g(e,t){const o=a.value.find(u=>u.product.key===e);o&&(t<=0?f(e):(o.quantity=t,o.totalPrice=o.unitPrice*t))}function q(e,t){const o=a.value.find(u=>u.product.key===e);o&&(o.unitPrice=t,o.totalPrice=t*o.quantity)}function I(){a.value=[],r.value=null,l.value="",n.value=""}function h(e){r.value=e}function D(e){l.value=e}function S(e){n.value=e}function C(){if(!r.value||a.value.length===0)throw new Error("Carrinho vazio ou cliente nÃ£o selecionado");const e={};return a.value.forEach(t=>{t.product.id&&(e[t.product.id]=t.quantity)}),{customerId:r.value.id,products:e,status:"PENDING",deliveryDate:l.value,cost:v.value,price:c.value,debt:c.value,profit:d.value}}function y(){const e={items:a.value,selectedCustomer:r.value,deliveryDate:l.value,observations:n.value};localStorage.setItem("verly-cart",JSON.stringify(e))}function b(){try{const e=localStorage.getItem("verly-cart");if(e){const t=JSON.parse(e);a.value=t.items||[],r.value=t.selectedCustomer||null,l.value=t.deliveryDate||"",n.value=t.observations||""}}catch(e){console.error("Erro ao carregar carrinho do localStorage:",e)}}function k(){N([a,r,l,n],()=>{y()},{deep:!0})}return{items:a,selectedCustomer:r,deliveryDate:l,observations:n,totalItems:p,totalValue:c,totalCost:v,totalProfit:d,isEmpty:m,addItem:P,removeItem:f,updateQuantity:g,updateUnitPrice:q,clearCart:I,setCustomer:h,setDeliveryDate:D,setObservations:S,getOrderData:C,saveToStorage:y,loadFromStorage:b,setupAutoSave:k}});export{F as q};
