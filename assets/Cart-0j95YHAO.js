import{d as R,r as x,k as I,o as $,c as i,b as a,e as t,f as c,t as n,g as l,q as D,m as E,p as B,F as y,y as h,h as v,D as q,v as _,B as z,i as L,s as T}from"./index-DcZlzi53.js";import{u as A}from"./cart-CDwYGn0D.js";import{c as N}from"./customer-CYEi1lpS.js";import{o as O}from"./order-COkXjOJN.js";import"./api-1h7xoGYc.js";const U={class:"min-h-screen bg-gray-50 py-8"},Q={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},H={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},K={class:"lg:col-span-2"},G={class:"bg-white rounded-lg shadow-sm border border-gray-200"},J={class:"p-6 border-b border-gray-200"},W={class:"text-sm text-gray-500 mt-1"},X={key:0,class:"p-12 text-center"},Y={key:1,class:"divide-y divide-gray-200"},Z={class:"flex items-start space-x-4"},tt={class:"flex-1 min-w-0"},et={class:"flex items-start justify-between"},st={class:"flex-1"},ot={class:"text-lg font-medium text-gray-900"},rt={class:"mt-1 text-sm text-gray-500 space-y-1"},nt={key:0},lt={key:1},it={key:2},at={key:3},dt=["onClick"],ut={class:"mt-4 flex items-center justify-between"},ct={class:"flex items-center space-x-3"},mt={class:"flex items-center border border-gray-300 rounded-md"},pt=["onClick","disabled"],gt=["value","onInput"],xt=["onClick"],bt={class:"flex items-center space-x-4"},vt={class:"text-right"},ft={class:"flex items-center mt-1"},yt=["value","onInput"],ht={class:"text-right"},_t={class:"text-lg font-semibold text-gray-900"},kt={class:"lg:col-span-1"},wt={class:"bg-white rounded-lg shadow-sm border border-gray-200 sticky top-8"},Ct={class:"p-6"},St={class:"mb-6"},Vt=["value"],jt={class:"mb-6"},Pt={class:"mb-6"},Ft={class:"mb-6"},Mt={class:"space-y-3"},Rt={class:"p-3 border border-gray-200 rounded-lg bg-green-50"},It={class:"flex justify-between items-center"},$t={class:"text-lg font-semibold text-green-900"},Dt={class:"p-3 border border-gray-200 rounded-lg bg-blue-50"},Et={class:"flex justify-between items-center"},Bt={class:"text-lg font-semibold text-blue-900"},qt={class:"text-xs text-blue-600 mt-1"},zt={class:"border-t border-gray-200 pt-4 space-y-2"},Lt={class:"flex justify-between text-sm"},Tt={class:"text-gray-600"},At={class:"font-medium"},Nt={class:"flex justify-between text-sm"},Ot={class:"font-medium"},Ut={class:"flex justify-between text-sm"},Qt={class:"font-medium text-green-600"},Ht={class:"border-t border-gray-200 pt-2"},Kt={class:"flex justify-between text-lg font-semibold"},Gt={class:"mt-6 space-y-3"},Jt=["disabled"],Wt={key:0},Xt={key:1},Yt=["disabled"],Zt={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},le=R({__name:"Cart",setup(te){const f=L(),o=A(),m=x([]),d=x(""),p=x(!1),g=x(!1);I(()=>m.value.find(r=>r.id?.toString()===d.value.toString())||null),$(async()=>{await k(),o.loadFromStorage(),o.setupAutoSave()});async function k(){try{const r=await N.getAllNonPaginated();m.value=Array.isArray(r)?r:r.content||[]}catch(r){console.error("Erro ao carregar clientes:",r)}}function w(){const r=m.value.find(e=>e.id?.toString()===d.value.toString());o.setCustomer(r||null)}function C(r){o.removeItem(r)}function b(r,e){o.updateQuantity(r,e)}function S(r,e){o.updateUnitPrice(r,e)}function V(){confirm("Tem certeza que deseja limpar o carrinho?")&&(o.clearCart(),d.value="")}async function j(){if(!d.value){alert("Por favor, selecione um cliente");return}if(o.isEmpty){alert("Carrinho está vazio");return}try{p.value=!0;const r=o.getOrderData();await O.create(r),g.value=!0,o.clearCart(),d.value=""}catch(r){console.error("Erro ao criar pedido:",r),alert("Erro ao criar pedido. Tente novamente.")}finally{p.value=!1}}function P(){g.value=!1,f.push("/products")}function F(){g.value=!1,f.push("/orders")}return(r,e)=>{const M=B("router-link");return a(),i("div",U,[t("div",Q,[e[26]||(e[26]=t("div",{class:"mb-8"},[t("h1",{class:"text-3xl font-bold text-gray-900"},"Carrinho de Compras"),t("p",{class:"mt-2 text-gray-600"},"Revise seus itens e finalize o pedido")],-1)),t("div",H,[t("div",K,[t("div",G,[t("div",J,[e[3]||(e[3]=t("h2",{class:"text-lg font-semibold text-gray-900"},"Itens do Carrinho",-1)),t("p",W,n(l(o).totalItems)+" "+n(l(o).totalItems===1?"item":"itens"),1)]),l(o).isEmpty?(a(),i("div",X,[e[5]||(e[5]=t("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})],-1)),e[6]||(e[6]=t("h3",{class:"mt-4 text-lg font-medium text-gray-900"},"Carrinho vazio",-1)),e[7]||(e[7]=t("p",{class:"mt-2 text-gray-500"},"Adicione produtos ao seu carrinho para continuar",-1)),D(M,{to:"/products",class:"mt-4 inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors"},{default:E(()=>[...e[4]||(e[4]=[T(" Ver Produtos ",-1)])]),_:1})])):(a(),i("div",Y,[(a(!0),i(y,null,h(l(o).items,s=>(a(),i("div",{key:s.product.key,class:"p-6"},[t("div",Z,[e[13]||(e[13]=t("div",{class:"flex-shrink-0 w-20 h-20 bg-gray-100 rounded-lg flex items-center justify-center"},[t("svg",{class:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})])],-1)),t("div",tt,[t("div",et,[t("div",st,[t("h3",ot,n(s.product.type||"Produto"),1),t("div",rt,[s.product.sheets?(a(),i("p",nt,"Folhas: "+n(s.product.sheets),1)):c("",!0),s.product.width&&s.product.height?(a(),i("p",lt," Dimensões: "+n(s.product.width)+"cm × "+n(s.product.height)+"cm ",1)):c("",!0),s.product.color?(a(),i("p",it,"Cor: "+n(s.product.color),1)):c("",!0),s.product.kit?(a(),i("p",at,"Kit: "+n(s.product.kit),1)):c("",!0)])]),t("button",{onClick:u=>C(s.product.key),class:"ml-4 text-red-600 hover:text-red-700 p-1",title:"Remover item"},[...e[8]||(e[8]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,dt)]),t("div",ut,[t("div",ct,[e[9]||(e[9]=t("label",{class:"text-sm font-medium text-gray-700"},"Quantidade:",-1)),t("div",mt,[t("button",{onClick:u=>b(s.product.key,s.quantity-1),class:"px-3 py-1 text-gray-600 hover:text-gray-800 hover:bg-gray-50",disabled:s.quantity<=1}," - ",8,pt),t("input",{value:s.quantity,onInput:u=>b(s.product.key,parseInt(u.target.value)||1),type:"number",min:"1",class:"w-16 px-2 py-1 text-center border-0 focus:ring-0"},null,40,gt),t("button",{onClick:u=>b(s.product.key,s.quantity+1),class:"px-3 py-1 text-gray-600 hover:text-gray-800 hover:bg-gray-50"}," + ",8,xt)])]),t("div",bt,[t("div",vt,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-gray-700"},"Preço unitário:",-1)),t("div",ft,[e[10]||(e[10]=t("span",{class:"text-sm text-gray-500 mr-1"},"R$",-1)),t("input",{value:s.unitPrice.toFixed(2),onInput:u=>S(s.product.key,parseFloat(u.target.value)||0),type:"number",step:"0.01",min:"0",class:"w-24 px-2 py-1 text-right border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,40,yt)])]),t("div",ht,[e[12]||(e[12]=t("p",{class:"text-sm font-medium text-gray-700"},"Total:",-1)),t("p",_t,"R$ "+n(s.totalPrice.toFixed(2)),1)])])])])])]))),128))]))])]),t("div",kt,[t("div",wt,[t("div",Ct,[e[25]||(e[25]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Resumo do Pedido",-1)),t("div",St,[e[15]||(e[15]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Cliente",-1)),v(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>d.value=s),onChange:w,class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:""},[e[14]||(e[14]=t("option",{value:""},"Selecione um cliente",-1)),(a(!0),i(y,null,h(m.value,s=>(a(),i("option",{key:s.id,value:s.id},n(s.name),9,Vt))),128))],544),[[q,d.value]])]),t("div",jt,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Data de Entrega",-1)),v(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>l(o).deliveryDate=s),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[_,l(o).deliveryDate]])]),t("div",Pt,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Observações",-1)),v(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=s=>l(o).observations=s),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Observações sobre o pedido..."},null,512),[[_,l(o).observations]])]),t("div",Ft,[e[21]||(e[21]=t("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"Opções de Pagamento",-1)),t("div",Mt,[t("div",Rt,[t("div",It,[e[18]||(e[18]=t("span",{class:"text-sm font-medium text-green-800"},"À Vista",-1)),t("span",$t,"R$ "+n(l(o).totalValue.toFixed(2)),1)]),e[19]||(e[19]=t("div",{class:"text-xs text-green-600 mt-1"},"Melhor preço disponível",-1))]),t("div",Dt,[t("div",Et,[e[20]||(e[20]=t("span",{class:"text-sm font-medium text-blue-800"},"Parcelado 12x",-1)),t("span",Bt,"R$ "+n((l(o).totalValue*1.2).toFixed(2)),1)]),t("div",qt,"12x de R$ "+n((l(o).totalValue*1.2/12).toFixed(2))+" sem juros",1)])])]),t("div",zt,[t("div",Lt,[t("span",Tt,"Subtotal ("+n(l(o).totalItems)+" itens):",1),t("span",At,"R$ "+n(l(o).totalValue.toFixed(2)),1)]),t("div",Nt,[e[22]||(e[22]=t("span",{class:"text-gray-600"},"Custo total:",-1)),t("span",Ot,"R$ "+n(l(o).totalCost.toFixed(2)),1)]),t("div",Ut,[e[23]||(e[23]=t("span",{class:"text-gray-600"},"Lucro estimado:",-1)),t("span",Qt,"R$ "+n(l(o).totalProfit.toFixed(2)),1)]),t("div",Ht,[t("div",Kt,[e[24]||(e[24]=t("span",null,"Total:",-1)),t("span",null,"R$ "+n(l(o).totalValue.toFixed(2)),1)])])]),t("div",Gt,[t("button",{onClick:j,disabled:l(o).isEmpty||!d.value||p.value,class:"w-full bg-blue-600 text-white py-3 px-4 rounded-md font-medium hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors"},[p.value?(a(),i("span",Wt,"Processando...")):(a(),i("span",Xt,"Finalizar Pedido"))],8,Jt),t("button",{onClick:V,disabled:l(o).isEmpty,class:"w-full bg-gray-100 text-gray-700 py-2 px-4 rounded-md font-medium hover:bg-gray-200 focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 disabled:bg-gray-50 disabled:text-gray-400 disabled:cursor-not-allowed transition-colors"}," Limpar Carrinho ",8,Yt)])])])])])]),g.value?(a(),i("div",Zt,[t("div",{class:"bg-white rounded-lg shadow-xl max-w-md w-full p-6"},[t("div",{class:"text-center"},[e[27]||(e[27]=z('<div class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100 mb-4"><svg class="h-6 w-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg></div><h3 class="text-lg font-medium text-gray-900 mb-2">Pedido Criado com Sucesso!</h3><p class="text-gray-500 mb-6">Seu pedido foi registrado e está sendo processado.</p>',3)),t("div",{class:"flex space-x-3"},[t("button",{onClick:F,class:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-md font-medium hover:bg-blue-700 transition-colors"}," Ver Pedidos "),t("button",{onClick:P,class:"flex-1 bg-gray-100 text-gray-700 py-2 px-4 rounded-md font-medium hover:bg-gray-200 transition-colors"}," Continuar Comprando ")])])])])):c("",!0)])}}});export{le as default};
