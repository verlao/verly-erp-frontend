import{T as z,G as x,F as E,z as I,_ as i,f as t,u as c,a as o,E as l,C as M,b as L,O as v,g as h,W as f,Y as q,Q as k,i as A,t as O,c as T,L as n,e as D}from"./index-D6gXMe8l.js";import{q as G}from"./cart-D8lMqQeX-CIxq-HRq.js";import{i as Q}from"./customer-WExQ0j1N-shtQL4Ef.js";import{a as U}from"./order-Byjw7WAC-Bw4C_qA3.js";import"./api-FIA6GHks-BQrTW_pe.js";const _={class:"min-h-screen bg-gray-50 py-8"},B={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},H={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},W={class:"lg:col-span-2"},Y={class:"bg-white rounded-lg shadow-sm border border-gray-200"},K={class:"p-6 border-b border-gray-200"},J={class:"text-sm text-gray-500 mt-1"},N={key:0,class:"p-12 text-center"},X={key:1,class:"divide-y divide-gray-200"},Z={class:"flex items-start space-x-4"},tt={class:"flex-1 min-w-0"},et={class:"flex items-start justify-between"},st={class:"flex-1"},at={class:"text-lg font-medium text-gray-900"},rt={class:"mt-1 text-sm text-gray-500 space-y-1"},ot={key:0},lt={key:1},it={key:2},nt={key:3},dt=["onClick"],ut={class:"mt-4 flex items-center justify-between"},ct={class:"flex items-center space-x-3"},mt={class:"flex items-center border border-gray-300 rounded-md"},pt=["onClick","disabled"],gt=["value","onInput"],xt=["onClick"],bt={class:"flex items-center space-x-4"},ft={class:"text-right"},yt={class:"flex items-center mt-1"},vt=["value","onInput"],ht={class:"text-right"},kt={class:"text-lg font-semibold text-gray-900"},wt={class:"lg:col-span-1"},Ct={class:"bg-white rounded-lg shadow-sm border border-gray-200 sticky top-8"},jt={class:"p-6"},Pt={class:"mb-6"},Ft=["value"],Vt={class:"mb-6"},Rt={class:"mb-6"},$t={class:"mb-6"},St={class:"space-y-3"},zt={class:"p-3 border border-gray-200 rounded-lg bg-green-50"},Et={class:"flex justify-between items-center"},It={class:"text-lg font-semibold text-green-900"},Mt={class:"p-3 border border-gray-200 rounded-lg bg-blue-50"},Lt={class:"flex justify-between items-center"},qt={class:"text-lg font-semibold text-blue-900"},At={class:"text-xs text-blue-600 mt-1"},Ot={class:"border-t border-gray-200 pt-4 space-y-2"},Tt={class:"flex justify-between text-sm"},Dt={class:"text-gray-600"},Gt={class:"font-medium"},Qt={class:"flex justify-between text-sm"},Ut={class:"font-medium"},_t={class:"flex justify-between text-sm"},Bt={class:"font-medium text-green-600"},Ht={class:"border-t border-gray-200 pt-2"},Wt={class:"flex justify-between text-lg font-semibold"},Yt={class:"mt-6 space-y-3"},Kt=["disabled"],Jt={key:0},Nt={key:1},Xt=["disabled"],Zt={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},le=z({__name:"Cart",setup(te){const y=O(),a=G(),m=x([]),d=x(""),p=x(!1),g=x(!1);E(()=>m.value.find(r=>r.id?.toString()===d.value.toString())||null),I(async()=>{await w(),a.loadFromStorage(),a.setupAutoSave()});async function w(){try{const r=await Q.getAllNonPaginated();m.value=Array.isArray(r)?r:r.content||[]}catch(r){console.error("Erro ao carregar clientes:",r)}}function C(){const r=m.value.find(e=>e.id?.toString()===d.value.toString());a.setCustomer(r||null)}function j(r){a.removeItem(r)}function b(r,e){a.updateQuantity(r,e)}function P(r,e){a.updateUnitPrice(r,e)}function F(){confirm("Tem certeza que deseja limpar o carrinho?")&&(a.clearCart(),d.value="")}async function V(){if(!d.value){alert("Por favor, selecione um cliente");return}if(a.isEmpty){alert("Carrinho está vazio");return}try{p.value=!0;const r=a.getOrderData();await U.create(r),g.value=!0,a.clearCart(),d.value=""}catch(r){console.error("Erro ao criar pedido:",r),alert("Erro ao criar pedido. Tente novamente.")}finally{p.value=!1}}function R(){g.value=!1,y.push("/products")}function $(){g.value=!1,y.push("/orders")}return(r,e)=>{const S=T("router-link");return n(),i("div",_,[t("div",B,[e[26]||(e[26]=t("div",{class:"mb-8"},[t("h1",{class:"text-3xl font-bold text-gray-900"},"Carrinho de Compras"),t("p",{class:"mt-2 text-gray-600"},"Revise seus itens e finalize o pedido")],-1)),t("div",H,[t("div",W,[t("div",Y,[t("div",K,[e[3]||(e[3]=t("h2",{class:"text-lg font-semibold text-gray-900"},"Itens do Carrinho",-1)),t("p",J,o(l(a).totalItems)+" "+o(l(a).totalItems===1?"item":"itens"),1)]),l(a).isEmpty?(n(),i("div",N,[e[5]||(e[5]=t("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})],-1)),e[6]||(e[6]=t("h3",{class:"mt-4 text-lg font-medium text-gray-900"},"Carrinho vazio",-1)),e[7]||(e[7]=t("p",{class:"mt-2 text-gray-500"},"Adicione produtos ao seu carrinho para continuar",-1)),M(S,{to:"/products",class:"mt-4 inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors"},{default:L(()=>[...e[4]||(e[4]=[D(" Ver Produtos ",-1)])]),_:1})])):(n(),i("div",X,[(n(!0),i(v,null,h(l(a).items,s=>(n(),i("div",{key:s.product.key,class:"p-6"},[t("div",Z,[e[13]||(e[13]=t("div",{class:"flex-shrink-0 w-20 h-20 bg-gray-100 rounded-lg flex items-center justify-center"},[t("svg",{class:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})])],-1)),t("div",tt,[t("div",et,[t("div",st,[t("h3",at,o(s.product.type||"Produto"),1),t("div",rt,[s.product.sheets?(n(),i("p",ot,"Folhas: "+o(s.product.sheets),1)):c("",!0),s.product.width&&s.product.height?(n(),i("p",lt," Dimensões: "+o(s.product.width)+"cm × "+o(s.product.height)+"cm ",1)):c("",!0),s.product.color?(n(),i("p",it,"Cor: "+o(s.product.color),1)):c("",!0),s.product.kit?(n(),i("p",nt,"Kit: "+o(s.product.kit),1)):c("",!0)])]),t("button",{onClick:u=>j(s.product.key),class:"ml-4 text-red-600 hover:text-red-700 p-1",title:"Remover item"},[...e[8]||(e[8]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,dt)]),t("div",ut,[t("div",ct,[e[9]||(e[9]=t("label",{class:"text-sm font-medium text-gray-700"},"Quantidade:",-1)),t("div",mt,[t("button",{onClick:u=>b(s.product.key,s.quantity-1),class:"px-3 py-1 text-gray-600 hover:text-gray-800 hover:bg-gray-50",disabled:s.quantity<=1}," - ",8,pt),t("input",{value:s.quantity,onInput:u=>b(s.product.key,parseInt(u.target.value)||1),type:"number",min:"1",class:"w-16 px-2 py-1 text-center border-0 focus:ring-0"},null,40,gt),t("button",{onClick:u=>b(s.product.key,s.quantity+1),class:"px-3 py-1 text-gray-600 hover:text-gray-800 hover:bg-gray-50"}," + ",8,xt)])]),t("div",bt,[t("div",ft,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-gray-700"},"Preço unitário:",-1)),t("div",yt,[e[10]||(e[10]=t("span",{class:"text-sm text-gray-500 mr-1"},"R$",-1)),t("input",{value:s.unitPrice.toFixed(2),onInput:u=>P(s.product.key,parseFloat(u.target.value)||0),type:"number",step:"0.01",min:"0",class:"w-24 px-2 py-1 text-right border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,40,vt)])]),t("div",ht,[e[12]||(e[12]=t("p",{class:"text-sm font-medium text-gray-700"},"Total:",-1)),t("p",kt,"R$ "+o(s.totalPrice.toFixed(2)),1)])])])])])]))),128))]))])]),t("div",wt,[t("div",Ct,[t("div",jt,[e[25]||(e[25]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Resumo do Pedido",-1)),t("div",Pt,[e[15]||(e[15]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Cliente",-1)),f(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>d.value=s),onChange:C,class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:""},[e[14]||(e[14]=t("option",{value:""},"Selecione um cliente",-1)),(n(!0),i(v,null,h(m.value,s=>(n(),i("option",{key:s.id,value:s.id},o(s.name),9,Ft))),128))],544),[[q,d.value]])]),t("div",Vt,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Data de Entrega",-1)),f(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>l(a).deliveryDate=s),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[k,l(a).deliveryDate]])]),t("div",Rt,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Observações",-1)),f(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=s=>l(a).observations=s),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Observações sobre o pedido..."},null,512),[[k,l(a).observations]])]),t("div",$t,[e[21]||(e[21]=t("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"Opções de Pagamento",-1)),t("div",St,[t("div",zt,[t("div",Et,[e[18]||(e[18]=t("span",{class:"text-sm font-medium text-green-800"},"À Vista",-1)),t("span",It,"R$ "+o(l(a).totalValue.toFixed(2)),1)]),e[19]||(e[19]=t("div",{class:"text-xs text-green-600 mt-1"},"Melhor preço disponível",-1))]),t("div",Mt,[t("div",Lt,[e[20]||(e[20]=t("span",{class:"text-sm font-medium text-blue-800"},"Parcelado 12x",-1)),t("span",qt,"R$ "+o((l(a).totalValue*1.2).toFixed(2)),1)]),t("div",At,"12x de R$ "+o((l(a).totalValue*1.2/12).toFixed(2))+" sem juros",1)])])]),t("div",Ot,[t("div",Tt,[t("span",Dt,"Subtotal ("+o(l(a).totalItems)+" itens):",1),t("span",Gt,"R$ "+o(l(a).totalValue.toFixed(2)),1)]),t("div",Qt,[e[22]||(e[22]=t("span",{class:"text-gray-600"},"Custo total:",-1)),t("span",Ut,"R$ "+o(l(a).totalCost.toFixed(2)),1)]),t("div",_t,[e[23]||(e[23]=t("span",{class:"text-gray-600"},"Lucro estimado:",-1)),t("span",Bt,"R$ "+o(l(a).totalProfit.toFixed(2)),1)]),t("div",Ht,[t("div",Wt,[e[24]||(e[24]=t("span",null,"Total:",-1)),t("span",null,"R$ "+o(l(a).totalValue.toFixed(2)),1)])])]),t("div",Yt,[t("button",{onClick:V,disabled:l(a).isEmpty||!d.value||p.value,class:"w-full bg-blue-600 text-white py-3 px-4 rounded-md font-medium hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors"},[p.value?(n(),i("span",Jt,"Processando...")):(n(),i("span",Nt,"Finalizar Pedido"))],8,Kt),t("button",{onClick:F,disabled:l(a).isEmpty,class:"w-full bg-gray-100 text-gray-700 py-2 px-4 rounded-md font-medium hover:bg-gray-200 focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 disabled:bg-gray-50 disabled:text-gray-400 disabled:cursor-not-allowed transition-colors"}," Limpar Carrinho ",8,Xt)])])])])])]),g.value?(n(),i("div",Zt,[t("div",{class:"bg-white rounded-lg shadow-xl max-w-md w-full p-6"},[t("div",{class:"text-center"},[e[27]||(e[27]=A('<div class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100 mb-4"><svg class="h-6 w-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg></div><h3 class="text-lg font-medium text-gray-900 mb-2">Pedido Criado com Sucesso!</h3><p class="text-gray-500 mb-6">Seu pedido foi registrado e está sendo processado.</p>',3)),t("div",{class:"flex space-x-3"},[t("button",{onClick:$,class:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-md font-medium hover:bg-blue-700 transition-colors"}," Ver Pedidos "),t("button",{onClick:R,class:"flex-1 bg-gray-100 text-gray-700 py-2 px-4 rounded-md font-medium hover:bg-gray-200 transition-colors"}," Continuar Comprando ")])])])])):c("",!0)])}}});export{le as default};
