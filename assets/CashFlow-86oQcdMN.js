import{d as Z,r as n,k as G,o as K,A as Q,c as l,b as i,e,f as I,s as S,h as c,v as b,t as a,n as m,F as _,y as j,w as W,D as ee}from"./index-Cim79vwX.js";import w from"./api-FIA6GHks.js";import{o as te}from"./order-Byjw7WAC.js";import{c as se}from"./customer-WExQ0j1N.js";const h={getAll:async()=>(await w.get("/cash-flow")).data,getByDateRange:async(p,d)=>(await w.get(`/cash-flow/date-range?startDate=${p}&endDate=${d}`)).data,create:async p=>(await w.post("/cash-flow",p)).data,update:async(p,d)=>(await w.patch(`/cash-flow/${p}`,d)).data,delete:async p=>(await w.delete(`/cash-flow/${p}`)).data},oe={class:"flex justify-between items-center mb-6"},re={class:"bg-white p-4 rounded-lg shadow mb-6"},ae={class:"flex flex-col md:flex-row md:items-center space-y-4 md:space-y-0 md:space-x-4"},ne={class:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6"},le={class:"bg-white p-6 rounded-lg shadow"},ie={class:"text-2xl font-semibold text-green-600"},de={class:"bg-white p-6 rounded-lg shadow"},ue={class:"text-2xl font-semibold text-red-600"},pe={class:"bg-white p-6 rounded-lg shadow"},ce={class:"bg-white rounded-lg shadow overflow-hidden"},me={key:0,class:"p-6 text-center"},xe={key:1,class:"p-6 text-center"},fe={key:2,class:"overflow-x-auto"},ge={class:"min-w-full divide-y divide-gray-200"},ye={class:"bg-white divide-y divide-gray-200"},ve={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},be={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},we={class:"px-6 py-4 whitespace-nowrap"},he={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},ke={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Ce={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},De={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},Ee=["onClick"],Me=["onClick"],Ne={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},Te={class:"bg-white rounded-xl shadow-2xl w-full max-w-lg mx-auto max-h-[90vh] overflow-y-auto"},$e={class:"p-6 border-b border-gray-200"},Se={class:"flex items-center justify-between"},Ae={class:"text-xl font-semibold text-gray-900"},Ie={class:"space-y-6"},_e={class:"grid grid-cols-2 gap-3"},je={class:"relative"},Re=["value"],Ve={class:"flex flex-col sm:flex-row justify-end space-y-3 sm:space-y-0 sm:space-x-3 mt-8 pt-6 border-t border-gray-200"},Be=["disabled"],Oe={key:0,class:"flex items-center justify-center"},Pe={key:1},ze={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Ue={class:"bg-white rounded-lg shadow-lg w-full max-w-md mx-4"},qe={class:"p-6"},He={class:"mt-6 flex justify-end space-x-3"},Xe=["disabled"],Ze=Z({__name:"CashFlow",setup(p){const d=n([]),k=n([]),A=n([]),N=n(!0),x=n(!1),C=n(!1),f=n(!1),g=n(!1),D=n(!1),u=n({startDate:new Date(new Date().getFullYear(),new Date().getMonth(),1).toISOString().split("T")[0],endDate:new Date().toISOString().split("T")[0]}),r=n({description:"",cash:0,type:"INCOME",person:""}),T=n(null),E=G(()=>{let o=0,t=0;return d.value.forEach(s=>{s.type==="ENTRADA"||s.type==="INCOME"?o+=s.cash:(s.type==="SAIDA"||s.type==="EXPENSE")&&(t+=s.cash)}),{income:o,expense:t,balance:o-t}});K(async()=>{await Promise.all([y(),R(),V()])}),Q(()=>[u.value.startDate,u.value.endDate],async([o,t],[s,v])=>{(o!==s||t!==v)&&await y()},{deep:!0});async function y(){try{N.value=!0,u.value.startDate&&u.value.endDate?d.value=await h.getByDateRange(u.value.startDate,u.value.endDate):d.value=await h.getAll()}catch(o){console.error("Erro ao carregar fluxo de caixa:",o)}finally{N.value=!1}}async function R(){try{k.value=await te.getAll()}catch(o){console.error("Erro ao carregar pedidos:",o)}}async function V(){try{A.value=await se.getAll()}catch(o){console.error("Erro ao carregar clientes:",o)}}function B(o){const t=A.value.find(s=>s.id===o);return t?t.name:`Cliente #${o}`}function O(o){return o==="INCOME"||o==="ENTRADA"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}function P(o){return o==="INCOME"||o==="ENTRADA"?"Entrada":"Saída"}function z(o){if(!o)return"-";let t;if(Array.isArray(o)){const[s,v,F,L=0,Y=0,J=0]=o;t=new Date(s,v-1,F,L,Y,J)}else t=new Date(o);return isNaN(t.getTime())?"Data inválida":new Intl.DateTimeFormat("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(t)}function M(o){return o.toFixed(2)}function U(){y()}function $(o){o?(r.value={...o},f.value=!0):(r.value={description:"",cash:0,type:"INCOME",person:""},f.value=!1),x.value=!0}async function q(){try{g.value=!0,f.value&&r.value.id?await h.update(r.value.id,r.value):await h.create(r.value),x.value=!1,await y()}catch(o){console.error("Erro ao salvar transação:",o)}finally{g.value=!1}}function H(o){T.value=o,C.value=!0}async function X(){if(T.value?.id)try{D.value=!0,await h.delete(T.value.id),C.value=!1,await y()}catch(o){console.error("Erro ao excluir transação:",o)}finally{D.value=!1}}return(o,t)=>(i(),l("div",null,[e("div",oe,[t[14]||(t[14]=e("h1",{class:"text-2xl font-semibold"},"Fluxo de Caixa",-1)),e("button",{onClick:t[0]||(t[0]=s=>$()),class:"px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90 flex items-center"},[...t[13]||(t[13]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"lucide lucide-plus mr-2"},[e("path",{d:"M5 12h14"}),e("path",{d:"M12 5v14"})],-1),S(" Nova Transação ",-1)])])]),e("div",re,[e("div",ae,[e("div",null,[t[15]||(t[15]=e("label",{for:"startDate",class:"block text-sm font-medium text-gray-700 mb-1"},"Data Inicial",-1)),c(e("input",{id:"startDate","onUpdate:modelValue":t[1]||(t[1]=s=>u.value.startDate=s),type:"date",class:"px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary"},null,512),[[b,u.value.startDate]])]),e("div",null,[t[16]||(t[16]=e("label",{for:"endDate",class:"block text-sm font-medium text-gray-700 mb-1"},"Data Final",-1)),c(e("input",{id:"endDate","onUpdate:modelValue":t[2]||(t[2]=s=>u.value.endDate=s),type:"date",class:"px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary"},null,512),[[b,u.value.endDate]])]),e("div",{class:"flex items-end"},[e("button",{onClick:U,class:"px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90"}," Filtrar ")])])]),e("div",ne,[e("div",le,[t[17]||(t[17]=e("h3",{class:"text-sm font-medium text-gray-500 mb-2"},"Entradas",-1)),e("p",ie,"R$ "+a(M(E.value.income)),1)]),e("div",de,[t[18]||(t[18]=e("h3",{class:"text-sm font-medium text-gray-500 mb-2"},"Saídas",-1)),e("p",ue,"R$ "+a(M(E.value.expense)),1)]),e("div",pe,[t[19]||(t[19]=e("h3",{class:"text-sm font-medium text-gray-500 mb-2"},"Saldo",-1)),e("p",{class:m(`text-2xl font-semibold ${E.value.balance>=0?"text-green-600":"text-red-600"}`)}," R$ "+a(M(E.value.balance)),3)])]),e("div",ce,[N.value?(i(),l("div",me,[...t[20]||(t[20]=[e("p",null,"Carregando...",-1)])])):d.value.length===0?(i(),l("div",xe,[...t[21]||(t[21]=[e("p",null,"Nenhuma transação encontrada",-1)])])):(i(),l("div",fe,[e("table",ge,[t[22]||(t[22]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"ID"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Descrição"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Tipo"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Valor"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Pedido"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Pessoa"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Data"),e("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Ações")])],-1)),e("tbody",ye,[(i(!0),l(_,null,j(d.value,s=>(i(),l("tr",{key:s.id},[e("td",ve,"#"+a(s.id),1),e("td",be,a(s.description),1),e("td",we,[e("span",{class:m([O(s.type),"px-2 inline-flex text-xs leading-5 font-semibold rounded-full"])},a(P(s.type)),3)]),e("td",{class:m(`px-6 py-4 whitespace-nowrap text-sm font-medium ${s.type==="INCOME"||s.type==="ENTRADA"?"text-green-600":"text-red-600"}`)}," R$ "+a(M(s.cash)),3),e("td",he,a(s.orderId?`#${s.orderId}`:"-"),1),e("td",ke,a(s.person),1),e("td",Ce,a(z(s.createdDate)),1),e("td",De,[e("button",{onClick:v=>$(s),class:"text-blue-600 hover:text-blue-900 mr-3"}," Editar ",8,Ee),e("button",{onClick:v=>H(s),class:"text-red-600 hover:text-red-900"}," Excluir ",8,Me)])]))),128))])])]))]),e("button",{onClick:t[3]||(t[3]=s=>$()),class:"fixed bottom-6 right-6 w-14 h-14 bg-blue-600 text-white rounded-full shadow-lg hover:shadow-xl hover:bg-blue-700 focus:outline-none focus:ring-4 focus:ring-blue-500/30 transition-all duration-200 z-40 flex items-center justify-center group"},[...t[23]||(t[23]=[e("svg",{class:"w-6 h-6 transition-transform group-hover:rotate-90",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])]),x.value?(i(),l("div",Ne,[e("div",Te,[e("div",$e,[e("div",Se,[e("h3",Ae,a(f.value?"Editar Transação":"Nova Transação"),1),e("button",{onClick:t[4]||(t[4]=s=>x.value=!1),class:"text-gray-400 hover:text-gray-600 transition-colors"},[...t[24]||(t[24]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])]),e("form",{onSubmit:W(q,["prevent"]),class:"p-6"},[e("div",Ie,[e("div",null,[t[27]||(t[27]=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"},"Tipo de Transação",-1)),e("div",_e,[e("button",{type:"button",onClick:t[5]||(t[5]=s=>r.value.type="INCOME"),class:m(["flex flex-col items-center p-4 rounded-lg border-2 transition-all duration-200",r.value.type==="INCOME"?"border-green-600 bg-green-100 text-green-800 shadow-md":"border-gray-200 bg-white text-gray-600 hover:border-green-400 hover:bg-green-50"])},[...t[25]||(t[25]=[e("svg",{class:"w-8 h-8 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),e("span",{class:"font-medium"},"Entrada",-1),e("span",{class:"text-xs opacity-75"},"Receita",-1)])],2),e("button",{type:"button",onClick:t[6]||(t[6]=s=>r.value.type="EXPENSE"),class:m(["flex flex-col items-center p-4 rounded-lg border-2 transition-all duration-200",r.value.type==="EXPENSE"?"border-red-500 bg-red-50 text-red-700":"border-gray-200 bg-white text-gray-600 hover:border-red-300 hover:bg-red-50"])},[...t[26]||(t[26]=[e("svg",{class:"w-8 h-8 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 12H4"})],-1),e("span",{class:"font-medium"},"Saída",-1),e("span",{class:"text-xs opacity-75"},"Despesa",-1)])],2)])]),e("div",null,[t[28]||(t[28]=e("label",{for:"description",class:"block text-sm font-medium text-gray-700 mb-2"},"Descrição",-1)),c(e("input",{id:"description","onUpdate:modelValue":t[7]||(t[7]=s=>r.value.description=s),type:"text",required:"",placeholder:"Ex: Pagamento de fornecedor, Venda de produto...",class:"block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all"},null,512),[[b,r.value.description]])]),e("div",null,[t[30]||(t[30]=e("label",{for:"cash",class:"block text-sm font-medium text-gray-700 mb-2"},"Valor",-1)),e("div",je,[t[29]||(t[29]=e("span",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 font-medium"},"R$",-1)),c(e("input",{id:"cash","onUpdate:modelValue":t[8]||(t[8]=s=>r.value.cash=s),type:"number",step:"0.01",min:"0",required:"",placeholder:"0,00",class:"block w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all"},null,512),[[b,r.value.cash,void 0,{number:!0}]])])]),e("div",null,[t[31]||(t[31]=e("label",{for:"person",class:"block text-sm font-medium text-gray-700 mb-2"},"Pessoa/Empresa",-1)),c(e("input",{id:"person","onUpdate:modelValue":t[9]||(t[9]=s=>r.value.person=s),type:"text",required:"",placeholder:"Ex: João Silva, Empresa XYZ...",class:"block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all"},null,512),[[b,r.value.person]])]),e("div",null,[t[33]||(t[33]=e("label",{for:"orderId",class:"block text-sm font-medium text-gray-700 mb-2"},[S("Pedido "),e("span",{class:"text-gray-400 text-xs"},"(opcional)")],-1)),c(e("select",{id:"orderId","onUpdate:modelValue":t[10]||(t[10]=s=>r.value.orderId=s),class:"block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all"},[t[32]||(t[32]=e("option",{value:null},"Selecione um pedido...",-1)),(i(!0),l(_,null,j(k.value,s=>(i(),l("option",{key:s.id,value:s.id}," #"+a(s.id)+" - "+a(B(s.customerId)),9,Re))),128))],512),[[ee,r.value.orderId]])])]),e("div",Ve,[e("button",{type:"button",onClick:t[11]||(t[11]=s=>x.value=!1),class:"w-full sm:w-auto px-6 py-3 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-all"}," Cancelar "),e("button",{type:"submit",disabled:g.value,class:m(["w-full sm:w-auto px-6 py-3 text-sm font-medium text-white rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 transition-all",r.value.type==="INCOME"?"bg-green-600 hover:bg-green-700 focus:ring-green-500":"bg-red-600 hover:bg-red-700 focus:ring-red-500",g.value?"opacity-50 cursor-not-allowed":""])},[g.value?(i(),l("span",Oe,[...t[34]||(t[34]=[e("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),S(" Salvando... ",-1)])])):(i(),l("span",Pe,a(f.value?"Atualizar Transação":"Criar Transação"),1))],10,Be)])],32)])])):I("",!0),C.value?(i(),l("div",ze,[e("div",Ue,[e("div",qe,[t[35]||(t[35]=e("h3",{class:"text-lg font-semibold mb-4"},"Confirmar Exclusão",-1)),t[36]||(t[36]=e("p",null,"Tem certeza que deseja excluir esta transação?",-1)),e("div",He,[e("button",{type:"button",onClick:t[12]||(t[12]=s=>C.value=!1),class:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50"}," Cancelar "),e("button",{type:"button",onClick:X,class:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",disabled:D.value},a(D.value?"Excluindo...":"Excluir"),9,Xe)])])])])):I("",!0)]))}});export{Ze as default};
