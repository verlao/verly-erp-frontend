import{T as G,G as o,F as J,z as Q,q as W,_ as n,f as e,u as $,e as T,W as p,Q as b,a as l,m,O as j,g as O,Z as K,Y as ee,L as i}from"./index-D6gXMe8l.js";import h from"./api-FIA6GHks-BQrTW_pe.js";import{a as ae}from"./order-Byjw7WAC-Bw4C_qA3.js";import{i as te}from"./customer-WExQ0j1N-shtQL4Ef.js";const w={getAll:async()=>(await h.get("/cash-flow")).data,getByDateRange:async(c,u)=>(await h.get(`/cash-flow/date-range?startDate=${c}&endDate=${u}`)).data,create:async c=>(await h.post("/cash-flow",c)).data,update:async(c,u)=>(await h.patch(`/cash-flow/${c}`,u)).data,delete:async c=>(await h.delete(`/cash-flow/${c}`)).data},re={class:"flex justify-between items-center mb-6"},se={class:"bg-white p-4 rounded-lg shadow mb-6"},le={class:"flex flex-col md:flex-row md:items-center space-y-4 md:space-y-0 md:space-x-4"},oe={class:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6"},ne={class:"bg-white p-6 rounded-lg shadow"},ie={class:"text-2xl font-semibold text-green-600"},de={class:"bg-white p-6 rounded-lg shadow"},ue={class:"text-2xl font-semibold text-red-600"},ce={class:"bg-white p-6 rounded-lg shadow"},pe={class:"bg-white rounded-lg shadow overflow-hidden"},me={key:0,class:"p-6 text-center"},xe={key:1,class:"p-6 text-center"},ge={key:2,class:"overflow-x-auto"},fe={class:"min-w-full divide-y divide-gray-200"},ye={class:"bg-white divide-y divide-gray-200"},ve={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},be={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},he={class:"px-6 py-4 whitespace-nowrap"},we={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},ke={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},De={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Ee={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},Ce=["onClick"],Ie=["onClick"],Ne={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},Ae={class:"bg-white rounded-xl shadow-2xl w-full max-w-lg mx-auto max-h-[90vh] overflow-y-auto"},Te={class:"p-6 border-b border-gray-200"},Me={class:"flex items-center justify-between"},Se={class:"text-xl font-semibold text-gray-900"},$e={class:"space-y-6"},je={class:"grid grid-cols-2 gap-3"},Oe={class:"relative"},Re=["value"],Ve={class:"flex flex-col sm:flex-row justify-end space-y-3 sm:space-y-0 sm:space-x-3 mt-8 pt-6 border-t border-gray-200"},ze=["disabled"],Be={key:0,class:"flex items-center justify-center"},Pe={key:1},Fe={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},qe={class:"bg-white rounded-lg shadow-lg w-full max-w-md mx-4"},Ue={class:"p-6"},He={class:"mt-6 flex justify-end space-x-3"},Xe=["disabled"],Ge=G({__name:"CashFlow",setup(c){const u=o([]),M=o([]),S=o([]),I=o(!0),x=o(!1),k=o(!1),g=o(!1),f=o(!1),D=o(!1),d=o({startDate:new Date(new Date().getFullYear(),new Date().getMonth(),1).toISOString().split("T")[0],endDate:new Date().toISOString().split("T")[0]}),s=o({description:"",cash:0,type:"INCOME",person:""}),N=o(null),E=J(()=>{let r=0,a=0;return u.value.forEach(t=>{t.type==="ENTRADA"||t.type==="INCOME"?r+=t.cash:(t.type==="SAIDA"||t.type==="EXPENSE")&&(a+=t.cash)}),{income:r,expense:a,balance:r-a}});Q(async()=>{await Promise.all([y(),R(),V()])}),W(()=>[d.value.startDate,d.value.endDate],async([r,a],[t,v])=>{(r!==t||a!==v)&&await y()},{deep:!0});async function y(){try{I.value=!0,d.value.startDate&&d.value.endDate?u.value=await w.getByDateRange(d.value.startDate,d.value.endDate):u.value=await w.getAll()}catch(r){console.error("Erro ao carregar fluxo de caixa:",r)}finally{I.value=!1}}async function R(){try{M.value=await ae.getAll()}catch(r){console.error("Erro ao carregar pedidos:",r)}}async function V(){try{S.value=await te.getAll()}catch(r){console.error("Erro ao carregar clientes:",r)}}function z(r){const a=S.value.find(t=>t.id===r);return a?a.name:`Cliente #${r}`}function B(r){return r==="INCOME"||r==="ENTRADA"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}function P(r){return r==="INCOME"||r==="ENTRADA"?"Entrada":"Saída"}function F(r){if(!r)return"-";let a;if(Array.isArray(r)){const[t,v,Y,_=0,L=0,Z=0]=r;a=new Date(t,v-1,Y,_,L,Z)}else a=new Date(r);return isNaN(a.getTime())?"Data inválida":new Intl.DateTimeFormat("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(a)}function C(r){return r.toFixed(2)}function q(){y()}function A(r){r?(s.value={...r},g.value=!0):(s.value={description:"",cash:0,type:"INCOME",person:""},g.value=!1),x.value=!0}async function U(){try{f.value=!0,g.value&&s.value.id?await w.update(s.value.id,s.value):await w.create(s.value),x.value=!1,await y()}catch(r){console.error("Erro ao salvar transação:",r)}finally{f.value=!1}}function H(r){N.value=r,k.value=!0}async function X(){if(N.value?.id)try{D.value=!0,await w.delete(N.value.id),k.value=!1,await y()}catch(r){console.error("Erro ao excluir transação:",r)}finally{D.value=!1}}return(r,a)=>(i(),n("div",null,[e("div",re,[a[14]||(a[14]=e("h1",{class:"text-2xl font-semibold"},"Fluxo de Caixa",-1)),e("button",{onClick:a[0]||(a[0]=t=>A()),class:"px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90 flex items-center"},[...a[13]||(a[13]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"lucide lucide-plus mr-2"},[e("path",{d:"M5 12h14"}),e("path",{d:"M12 5v14"})],-1),T(" Nova Transação ",-1)])])]),e("div",se,[e("div",le,[e("div",null,[a[15]||(a[15]=e("label",{for:"startDate",class:"block text-sm font-medium text-gray-700 mb-1"},"Data Inicial",-1)),p(e("input",{id:"startDate","onUpdate:modelValue":a[1]||(a[1]=t=>d.value.startDate=t),type:"date",class:"px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary"},null,512),[[b,d.value.startDate]])]),e("div",null,[a[16]||(a[16]=e("label",{for:"endDate",class:"block text-sm font-medium text-gray-700 mb-1"},"Data Final",-1)),p(e("input",{id:"endDate","onUpdate:modelValue":a[2]||(a[2]=t=>d.value.endDate=t),type:"date",class:"px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary"},null,512),[[b,d.value.endDate]])]),e("div",{class:"flex items-end"},[e("button",{onClick:q,class:"px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90"}," Filtrar ")])])]),e("div",oe,[e("div",ne,[a[17]||(a[17]=e("h3",{class:"text-sm font-medium text-gray-500 mb-2"},"Entradas",-1)),e("p",ie,"R$ "+l(C(E.value.income)),1)]),e("div",de,[a[18]||(a[18]=e("h3",{class:"text-sm font-medium text-gray-500 mb-2"},"Saídas",-1)),e("p",ue,"R$ "+l(C(E.value.expense)),1)]),e("div",ce,[a[19]||(a[19]=e("h3",{class:"text-sm font-medium text-gray-500 mb-2"},"Saldo",-1)),e("p",{class:m(`text-2xl font-semibold ${E.value.balance>=0?"text-green-600":"text-red-600"}`)}," R$ "+l(C(E.value.balance)),3)])]),e("div",pe,[I.value?(i(),n("div",me,[...a[20]||(a[20]=[e("p",null,"Carregando...",-1)])])):u.value.length===0?(i(),n("div",xe,[...a[21]||(a[21]=[e("p",null,"Nenhuma transação encontrada",-1)])])):(i(),n("div",ge,[e("table",fe,[a[22]||(a[22]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"ID"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Descrição"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Tipo"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Valor"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Pedido"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Pessoa"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Data"),e("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Ações")])],-1)),e("tbody",ye,[(i(!0),n(j,null,O(u.value,t=>(i(),n("tr",{key:t.id},[e("td",ve,"#"+l(t.id),1),e("td",be,l(t.description),1),e("td",he,[e("span",{class:m([B(t.type),"px-2 inline-flex text-xs leading-5 font-semibold rounded-full"])},l(P(t.type)),3)]),e("td",{class:m(`px-6 py-4 whitespace-nowrap text-sm font-medium ${t.type==="INCOME"||t.type==="ENTRADA"?"text-green-600":"text-red-600"}`)}," R$ "+l(C(t.cash)),3),e("td",we,l(t.orderId?`#${t.orderId}`:"-"),1),e("td",ke,l(t.person),1),e("td",De,l(F(t.createdDate)),1),e("td",Ee,[e("button",{onClick:v=>A(t),class:"text-blue-600 hover:text-blue-900 mr-3"}," Editar ",8,Ce),e("button",{onClick:v=>H(t),class:"text-red-600 hover:text-red-900"}," Excluir ",8,Ie)])]))),128))])])]))]),e("button",{onClick:a[3]||(a[3]=t=>A()),class:"fixed bottom-6 right-6 w-14 h-14 bg-blue-600 text-white rounded-full shadow-lg hover:shadow-xl hover:bg-blue-700 focus:outline-none focus:ring-4 focus:ring-blue-500/30 transition-all duration-200 z-40 flex items-center justify-center group"},[...a[23]||(a[23]=[e("svg",{class:"w-6 h-6 transition-transform group-hover:rotate-90",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])]),x.value?(i(),n("div",Ne,[e("div",Ae,[e("div",Te,[e("div",Me,[e("h3",Se,l(g.value?"Editar Transação":"Nova Transação"),1),e("button",{onClick:a[4]||(a[4]=t=>x.value=!1),class:"text-gray-400 hover:text-gray-600 transition-colors"},[...a[24]||(a[24]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])]),e("form",{onSubmit:K(U,["prevent"]),class:"p-6"},[e("div",$e,[e("div",null,[a[27]||(a[27]=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"},"Tipo de Transação",-1)),e("div",je,[e("button",{type:"button",onClick:a[5]||(a[5]=t=>s.value.type="INCOME"),class:m(["flex flex-col items-center p-4 rounded-lg border-2 transition-all duration-200",s.value.type==="INCOME"?"border-green-600 bg-green-100 text-green-800 shadow-md":"border-gray-200 bg-white text-gray-600 hover:border-green-400 hover:bg-green-50"])},[...a[25]||(a[25]=[e("svg",{class:"w-8 h-8 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),e("span",{class:"font-medium"},"Entrada",-1),e("span",{class:"text-xs opacity-75"},"Receita",-1)])],2),e("button",{type:"button",onClick:a[6]||(a[6]=t=>s.value.type="EXPENSE"),class:m(["flex flex-col items-center p-4 rounded-lg border-2 transition-all duration-200",s.value.type==="EXPENSE"?"border-red-500 bg-red-50 text-red-700":"border-gray-200 bg-white text-gray-600 hover:border-red-300 hover:bg-red-50"])},[...a[26]||(a[26]=[e("svg",{class:"w-8 h-8 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 12H4"})],-1),e("span",{class:"font-medium"},"Saída",-1),e("span",{class:"text-xs opacity-75"},"Despesa",-1)])],2)])]),e("div",null,[a[28]||(a[28]=e("label",{for:"description",class:"block text-sm font-medium text-gray-700 mb-2"},"Descrição",-1)),p(e("input",{id:"description","onUpdate:modelValue":a[7]||(a[7]=t=>s.value.description=t),type:"text",required:"",placeholder:"Ex: Pagamento de fornecedor, Venda de produto...",class:"block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all"},null,512),[[b,s.value.description]])]),e("div",null,[a[30]||(a[30]=e("label",{for:"cash",class:"block text-sm font-medium text-gray-700 mb-2"},"Valor",-1)),e("div",Oe,[a[29]||(a[29]=e("span",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 font-medium"},"R$",-1)),p(e("input",{id:"cash","onUpdate:modelValue":a[8]||(a[8]=t=>s.value.cash=t),type:"number",step:"0.01",min:"0",required:"",placeholder:"0,00",class:"block w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all"},null,512),[[b,s.value.cash,void 0,{number:!0}]])])]),e("div",null,[a[31]||(a[31]=e("label",{for:"person",class:"block text-sm font-medium text-gray-700 mb-2"},"Pessoa/Empresa",-1)),p(e("input",{id:"person","onUpdate:modelValue":a[9]||(a[9]=t=>s.value.person=t),type:"text",required:"",placeholder:"Ex: João Silva, Empresa XYZ...",class:"block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all"},null,512),[[b,s.value.person]])]),e("div",null,[a[33]||(a[33]=e("label",{for:"orderId",class:"block text-sm font-medium text-gray-700 mb-2"},[T("Pedido "),e("span",{class:"text-gray-400 text-xs"},"(opcional)")],-1)),p(e("select",{id:"orderId","onUpdate:modelValue":a[10]||(a[10]=t=>s.value.orderId=t),class:"block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all"},[a[32]||(a[32]=e("option",{value:null},"Selecione um pedido...",-1)),(i(!0),n(j,null,O(M.value,t=>(i(),n("option",{key:t.id,value:t.id}," #"+l(t.id)+" - "+l(z(t.customerId)),9,Re))),128))],512),[[ee,s.value.orderId]])])]),e("div",Ve,[e("button",{type:"button",onClick:a[11]||(a[11]=t=>x.value=!1),class:"w-full sm:w-auto px-6 py-3 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-all"}," Cancelar "),e("button",{type:"submit",disabled:f.value,class:m(["w-full sm:w-auto px-6 py-3 text-sm font-medium text-white rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 transition-all",s.value.type==="INCOME"?"bg-green-600 hover:bg-green-700 focus:ring-green-500":"bg-red-600 hover:bg-red-700 focus:ring-red-500",f.value?"opacity-50 cursor-not-allowed":""])},[f.value?(i(),n("span",Be,[...a[34]||(a[34]=[e("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),T(" Salvando... ",-1)])])):(i(),n("span",Pe,l(g.value?"Atualizar Transação":"Criar Transação"),1))],10,ze)])],32)])])):$("",!0),k.value?(i(),n("div",Fe,[e("div",qe,[e("div",Ue,[a[35]||(a[35]=e("h3",{class:"text-lg font-semibold mb-4"},"Confirmar Exclusão",-1)),a[36]||(a[36]=e("p",null,"Tem certeza que deseja excluir esta transação?",-1)),e("div",He,[e("button",{type:"button",onClick:a[12]||(a[12]=t=>k.value=!1),class:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50"}," Cancelar "),e("button",{type:"button",onClick:X,class:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",disabled:D.value},l(D.value?"Excluindo...":"Excluir"),9,Xe)])])])])):$("",!0)]))}});export{Ge as default};
